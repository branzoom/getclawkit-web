# 🦞 OpenClaw Nexus - 产品需求文档 (PRD) v2.1
**—— The "Unofficial Companion" for OpenClaw Ecosystem**
*(Final Execution Build - Do Not Edit)*

| 项目属性 | 内容 |
| :--- | :--- |
| **项目名称** | **OpenClaw Nexus** (代码代号: LobsterTrap) |
| **版本号** | **v2.1 (Definitive Edition)** |
| **文档日期** | 2026-02-04 |
| **项目负责人** | You (The Solo Vibe Coder) |
| **核心 KPI** | **MAU (Feb 28)** - 目标：> 5,000。 |
| **获胜策略** | **流量优先 (Traffic-First)**：所有功能必须具有分享属性或 SEO 价值。 |
| **技术核心** | Next.js 15 (ISR/API Routes) + Fuse.js + LocalStorage + Dual Analytics. |

---

## 1. 产品愿景与定位

### 1.1 核心痛点 (Why This Exists)
OpenClaw 生态虽火，但官方文档滞后，ClawHub CLI 与手动党并存，改名历史（ClawdBot/MoltBot）导致搜索混乱。用户急需一个**准确的配置工具**和**统一的资源索引**。

### 1.2 核心价值 (Value Proposition)
我们是 OpenClaw 的**“非官方伴侣”**。
*   **准确性**：提供通过验证的 JSON 配置（非 YAML，非 JSON5）。
*   **兼容性**：同时支持 Windows (`%USERPROFILE%`) 和 Unix (`~`) 路径。
*   **安全性**：零后端存储敏感信息，代码开源，建立信任。

### 1.3 流量获胜逻辑 (The Viral Loop)
1.  **SEO 拦截**：捕获所有旧关键词（ClawdBot/MoltBot）并导向新版工具。
2.  **实用即分享**：配置成功 -> 弹窗提示分享到 X/Discord。
3.  **状态即留存**：Status Page 成为用户每日确认环境的工具（书签流量）。

---

## 2. 核心功能模块 (Functional Specs)

### 2.1 模块 A：生态健康监控 (Status Hub) - **[High Retention]**
*   **技术实现 (关键修正)**：
    *   **Server-Side Fetching**: 必须使用 Next.js API Routes (`/api/status`) 或 Server Actions 请求外部 API，**严禁**在客户端直接 fetch `moltbook.ai` 或 `github.com`，以解决 **CORS 跨域问题**。
    *   **ISR 缓存**: 服务端设置 `revalidate: 60`，每分钟仅请求一次上游，避免触发 Rate Limit。
*   **监控对象**：
    1.  **OpenClaw Core**: GitHub Releases API (Latest Version).
    2.  **ClawHub Registry**: HTTP HEAD 请求官方仓库。
    3.  **Community**: Moltbook 站点连通性。
*   **交互与钩子**：
    *   状态全绿时，底部显示按钮：`"Share Status to Discord"` (文案: "OpenClaw Systems All Green! Check here: [URL]").

### 2.2 模块 B：智能配置向导 (Config Wizard) - **[High Acquisition]**
*   **技术实现 (关键修正)**：
    *   **标准 JSON**: 默认生成标准 JSON (Strict Mode)，**不使用 JSON5**，确保 100% 兼容性。
    *   **OS Toggle**: 添加 `[ macOS / Linux ]` vs `[ Windows ]` 切换开关。
*   **核心逻辑**：
    *   **Windows 路径处理**: 自动将路径中的 `/` 转换为 `\\` (双反斜杠转义)。例如：`C:\\Users\\Name\\.openclaw`.
    *   **API Key 安全**: 输入框显式标注 "Stored in LocalStorage only".
    *   **Legacy Converter**: 支持粘贴旧版 YAML，前端解析并转换为 JSON。
*   **分享钩子**：
    *   点击 "Copy JSON" 后，Toast 提示成功，并弹窗：*"Configured successfully! Help others by sharing this tool?"*

### 2.3 模块 C：Skill 索引 (Skill Registry) - **[Discovery]**
*   **数据源**：`github.com/your-username/awesome-openclaw-skills/data.json` (Raw fetch via Server Component)。
*   **搜索**：客户端 **Fuse.js** 模糊搜索 (Name, Desc, Author)。
*   **安装 UI (双模设计)**：
    *   **Tab A: CLI (推荐)** -> `clawhub install <name>`
    *   **Tab B: Manual (备用)** -> `mkdir -p ... && wget ...`
*   **SEO 策略 (分阶段)**：
    *   **Phase 1**: 所有 Skill 在一个大列表页展示。
    *   **Phase 2**: (如果开发有余力) 利用 `generateStaticParams` 生成 `/skill/[slug]` 独立页面。

### 2.4 模块 D：本地医生 (Local Doctor) - **[Virality]**
*   **展示形式**：只读代码框 + Copy 按钮。**不提供** `curl | bash` 命令（避免安全恐慌）。
*   **脚本逻辑**：
    *   **Unix (Bash)**: 检查 `node -v`, `clawhub --version`, 检查 `~/.openclaw` 读写权限。
    *   **Windows (PowerShell)**: 检查 `$env:USERPROFILE\.openclaw`。
    *   *脚本需内置一行注释*：`# Generated by OpenClaw Nexus - [URL]`。
*   **补充**：
    *   **安全卫士**：
        *   **检查项**：Check Exposure。
        *   **逻辑**：检测配置文件中的 host 字段。如果是 0.0.0.0，显示 🔴 红色高危警告：“你的 Agent 正裸奔在公网上！请立即改为 127.0.0.1 或配置鉴权。”
        *   **价值**：这一行代码就能让用户觉得你是“止痛药”。

### 2.5 模块 E：知识库 (Wiki)
*   **内容策略**：只写两篇高权重文章。
    1.  **《OpenClaw Migration Guide》**: 涵盖 "ClawdBot vs OpenClaw", "Config conversion"。
    2.  **《Troubleshooting Connection Issues》**: 涵盖 "API Key errors", "Dependency missing"。

### 2.6 模块 F：OpenClaw 烧钱计算器 (Token Cost Estimator)
*   **功能**：一个简单的滑块/输入框。
*   **输入**：
    *   **模型选择**：(Claude 3.5 Sonnet / GPT-4o / DeepSeek-V3)。
    *   **预计每日工作小时数**：
    *   **Agent 活跃度**：(低/中/高)。
*   **输出**：
    *   **预计每月账单**：$45.20。
    *   **对比**：如果用 DeepSeek，每月仅需 $2.10。
*   **分享钩子**：计算结果下方有按钮：“晒晒你的 AI 账单”。
*   **SEO 价值**：捕获 "OpenClaw pricing", "Claude API cost calculator" 等高价值流量。


## 3. 技术架构与埋点 (Tech Stack)

### 3.1 核心栈
*   **Frontend**: Next.js 15 (App Router).
*   **UI**: Tailwind CSS + Shadcn/UI.
*   **State**: React Context (Global OS Preference).
*   **Hosting**: Vercel (Free Tier).

### 3.2 双重埋点 (Dual Analytics)
为了比赛数据万无一失：
1.  **Umami**: 配置在 Vercel 上，作为**公开看板 (Public Dashboard)**，用于提交比赛截图。
2.  **Google Analytics 4 (GA4)**: 作为内部数据分析，监测 SEO 关键词和用户流向。
3.  **关键事件 (Custom Events)**:
    *   `config_generated` (Label: Windows/Unix)
    *   `skill_install_copy` (Label: CLI/Manual)
    *   `share_click` (Label: Twitter/Discord)

### 3.3 安全性 (Security)
*   **CSP**: 仅允许 fetch 自身 API 和 GitHub Raw。
*   **No-Referrer**: Config 页面强制 `<meta name="referrer" content="no-referrer" />`。

---

## 4. 执行路线图 (Execution Plan)

### Phase 1: 基础设施与工具 (Day 1-2)
*   **Day 1**:
    *   初始化 Next.js。
    *   编写 `/api/status` (Server Route) 解决 CORS。
    *   开发 Config Generator (JSON + Windows Logic)。
*   **Day 2**:
    *   搭建 GitHub `awesome` 仓库，Fork 数据。
    *   集成 Fuse.js 搜索列表。
    *   部署上线，配置 Umami。

### Phase 2: 内容填充与冷启动 (Day 3-4)
*   **Day 3**:
    *   撰写 Doctor 脚本 (Bash/PS1)。
    *   撰写 Wiki 两篇长文。
    *   **自测**：在 Windows 虚拟机和 Mac 上分别跑通流程。
*   **Day 4 (Go Live)**:
    *   在 Reddit `r/openclaw` 发帖（干货向）。
    *   在 X 上发布 "Local Doctor" 工具。

### Phase 3: 运营与优化 (Day 5-28)
*   **每日任务**:
    *   检查 Umami 数据。
    *   给 GitHub 上的 Skill 提 PR (刷存在感)。
    *   如果在 Discord 看到相关问题，甩链接。

---

## 5. 验收标准 (Success Criteria)

1.  **功能验收**:
    *   [ ] Status Page 在 iOS/Android 浏览器上无报错，状态显示正常 (CORS 解决验证)。
    *   [ ] Config Generator 切换到 Windows 模式时，路径变为 `C:\\Users\\...`。
    *   [ ] 生成的 JSON 文件复制到本地后，OpenClaw 官方程序能成功启动。
2.  **流量验收**:
    *   [ ] 2月10日前 DAU 突破 200。
    *   [ ] 2月28日前 MAU 突破 5,000。

---

## 6. 开发注意事项 (Developer Notes)

*   **不要过度设计**: CSS 能用就行，Shadcn 的默认样式足够好看。
*   **不要造假**: 数据源必须真实（来自 GitHub/Ping），不要用 `Math.random()` 生成假状态，程序员社区一眼就能看穿。
*   **环境变数**:
    *   `NEXT_PUBLIC_APP_NAME="OpenClaw Nexus"`
    *   `NEXT_PUBLIC_GITHUB_TOKEN` (可选，如果 GitHub API 频率超限，用于服务端鉴权提权)。

---

**最后确认：**
这是 v2.1 版本。逻辑已闭环，风险已排除。
**现在的任务只有一个：Write the code.**

祝你好运，把 Mac Mini 赢回来！🦞